  0%|                                                                                                                                | 0/2248 [00:00<?, ?it/s]  0%|                                                                                                                        | 1/2248 [00:00<11:57,  3.13it/s]  1%|█▌                                                                                                                     | 29/2248 [00:00<08:18,  4.45it/s]  2%|██▉                                                                                                                    | 56/2248 [00:00<05:47,  6.31it/s]  4%|████▎                                                                                                                  | 82/2248 [00:00<04:02,  8.92it/s]  5%|█████▋                                                                                                                | 108/2248 [00:00<02:50, 12.56it/s]  6%|███████                                                                                                               | 135/2248 [00:00<02:00, 17.59it/s]  7%|████████▌                                                                                                             | 163/2248 [00:00<01:25, 24.45it/s]  8%|█████████▉                                                                                                            | 190/2248 [00:01<01:01, 33.61it/s] 10%|███████████▎                                                                                                          | 215/2248 [00:01<00:44, 45.32it/s] 11%|████████████▌                                                                                                         | 240/2248 [00:01<00:33, 60.04it/s] 12%|█████████████▉                                                                                                        | 265/2248 [00:01<00:25, 77.56it/s] 13%|███████████████▏                                                                                                      | 290/2248 [00:01<00:20, 97.56it/s] 14%|████████████████▍                                                                                                    | 316/2248 [00:01<00:16, 119.71it/s] 15%|█████████████████▋                                                                                                   | 341/2248 [00:01<00:13, 141.58it/s] 16%|███████████████████                                                                                                  | 366/2248 [00:01<00:11, 161.53it/s] 17%|████████████████████▍                                                                                                | 392/2248 [00:01<00:10, 181.87it/s] 19%|█████████████████████▊                                                                                               | 418/2248 [00:01<00:09, 199.46it/s] 20%|███████████████████████                                                                                              | 444/2248 [00:02<00:08, 214.11it/s] 21%|████████████████████████▌                                                                                            | 473/2248 [00:02<00:07, 231.92it/s] 22%|██████████████████████████                                                                                           | 500/2248 [00:02<00:07, 236.74it/s] 23%|███████████████████████████▍                                                                                         | 528/2248 [00:02<00:06, 246.76it/s] 25%|████████████████████████████▉                                                                                        | 555/2248 [00:02<00:06, 249.64it/s] 26%|██████████████████████████████▎                                                                                      | 582/2248 [00:02<00:06, 249.17it/s] 27%|███████████████████████████████▋                                                                                     | 608/2248 [00:02<00:06, 243.16it/s] 28%|████████████████████████████████▉                                                                                    | 634/2248 [00:02<00:06, 244.36it/s] 29%|██████████████████████████████████▎                                                                                  | 659/2248 [00:02<00:06, 243.18it/s] 30%|███████████████████████████████████▋                                                                                 | 685/2248 [00:02<00:06, 247.64it/s] 32%|████████████████████████████████████▉                                                                                | 710/2248 [00:03<00:06, 239.26it/s] 33%|██████████████████████████████████████▎                                                                              | 736/2248 [00:03<00:06, 243.26it/s] 34%|███████████████████████████████████████▋                                                                             | 762/2248 [00:03<00:06, 246.67it/s] 35%|█████████████████████████████████████████                                                                            | 789/2248 [00:03<00:05, 251.03it/s] 36%|██████████████████████████████████████████▍                                                                          | 815/2248 [00:03<00:05, 249.69it/s] 37%|███████████████████████████████████████████▊                                                                         | 841/2248 [00:03<00:05, 247.72it/s] 39%|█████████████████████████████████████████████▏                                                                       | 868/2248 [00:03<00:05, 252.83it/s] 40%|██████████████████████████████████████████████▋                                                                      | 896/2248 [00:03<00:05, 257.66it/s] 41%|███████████████████████████████████████████████▉                                                                     | 922/2248 [00:03<00:05, 248.75it/s] 42%|█████████████████████████████████████████████████▎                                                                   | 948/2248 [00:04<00:05, 251.72it/s] 43%|██████████████████████████████████████████████████▋                                                                  | 974/2248 [00:04<00:05, 247.54it/s] 44%|███████████████████████████████████████████████████▌                                                                | 1000/2248 [00:04<00:05, 249.47it/s] 46%|█████████████████████████████████████████████████████                                                               | 1028/2248 [00:04<00:04, 256.82it/s] 47%|██████████████████████████████████████████████████████▍                                                             | 1055/2248 [00:04<00:04, 258.28it/s] 48%|███████████████████████████████████████████████████████▊                                                            | 1081/2248 [00:04<00:04, 252.33it/s] 49%|█████████████████████████████████████████████████████████                                                           | 1107/2248 [00:04<00:04, 248.74it/s] 50%|██████████████████████████████████████████████████████████▍                                                         | 1133/2248 [00:04<00:04, 249.63it/s] 52%|███████████████████████████████████████████████████████████▊                                                        | 1159/2248 [00:04<00:04, 251.18it/s] 53%|█████████████████████████████████████████████████████████████▏                                                      | 1186/2248 [00:04<00:04, 254.38it/s] 54%|██████████████████████████████████████████████████████████████▌                                                     | 1212/2248 [00:05<00:04, 253.88it/s] 55%|███████████████████████████████████████████████████████████████▉                                                    | 1238/2248 [00:05<00:03, 252.67it/s] 56%|█████████████████████████████████████████████████████████████████▍                                                  | 1267/2248 [00:05<00:03, 260.78it/s] 58%|██████████████████████████████████████████████████████████████████▊                                                 | 1294/2248 [00:05<00:03, 260.34it/s] 59%|████████████████████████████████████████████████████████████████████▏                                               | 1321/2248 [00:05<00:03, 254.13it/s] 60%|█████████████████████████████████████████████████████████████████████▌                                              | 1349/2248 [00:05<00:03, 259.42it/s] 61%|███████████████████████████████████████████████████████████████████████                                             | 1376/2248 [00:05<00:03, 247.36it/s] 62%|████████████████████████████████████████████████████████████████████████▍                                           | 1403/2248 [00:05<00:03, 252.99it/s] 64%|█████████████████████████████████████████████████████████████████████████▉                                          | 1432/2248 [00:05<00:03, 260.38it/s] 65%|███████████████████████████████████████████████████████████████████████████▎                                        | 1459/2248 [00:06<00:03, 260.56it/s] 66%|████████████████████████████████████████████████████████████████████████████▋                                       | 1486/2248 [00:06<00:02, 260.48it/s] 67%|██████████████████████████████████████████████████████████████████████████████                                      | 1513/2248 [00:06<00:02, 261.68it/s] 69%|███████████████████████████████████████████████████████████████████████████████▍                                    | 1540/2248 [00:06<00:02, 260.26it/s] 70%|████████████████████████████████████████████████████████████████████████████████▉                                   | 1568/2248 [00:06<00:02, 264.04it/s] 71%|██████████████████████████████████████████████████████████████████████████████████▎                                 | 1595/2248 [00:06<00:02, 264.46it/s] 72%|███████████████████████████████████████████████████████████████████████████████████▋                                | 1622/2248 [00:06<00:02, 255.48it/s] 73%|█████████████████████████████████████████████████████████████████████████████████████▏                              | 1650/2248 [00:06<00:02, 259.76it/s] 75%|██████████████████████████████████████████████████████████████████████████████████████▌                             | 1677/2248 [00:06<00:02, 256.65it/s] 76%|███████████████████████████████████████████████████████████████████████████████████████▉                            | 1703/2248 [00:07<00:02, 248.77it/s] 77%|█████████████████████████████████████████████████████████████████████████████████████████▏                          | 1729/2248 [00:07<00:02, 251.29it/s] 78%|██████████████████████████████████████████████████████████████████████████████████████████▋                         | 1757/2248 [00:07<00:01, 256.50it/s] 79%|████████████████████████████████████████████████████████████████████████████████████████████                        | 1784/2248 [00:07<00:01, 258.13it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████▍                      | 1810/2248 [00:07<00:01, 255.64it/s] 82%|██████████████████████████████████████████████████████████████████████████████████████████████▋                     | 1836/2248 [00:07<00:01, 255.37it/s] 83%|████████████████████████████████████████████████████████████████████████████████████████████████                    | 1862/2248 [00:07<00:01, 255.19it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 1890/2248 [00:07<00:01, 261.69it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 1917/2248 [00:07<00:01, 257.68it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████████████████▎               | 1944/2248 [00:07<00:01, 260.65it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 1973/2248 [00:08<00:01, 266.61it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 2000/2248 [00:08<00:00, 267.37it/s] 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 2029/2248 [00:08<00:00, 273.13it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 2058/2248 [00:08<00:00, 275.87it/s] 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 2086/2248 [00:08<00:00, 262.29it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 2113/2248 [00:08<00:00, 261.22it/s] 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 2141/2248 [00:08<00:00, 265.25it/s] 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 2168/2248 [00:08<00:00, 263.11it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 2195/2248 [00:08<00:00, 260.85it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 2222/2248 [00:08<00:00, 253.94it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2248/2248 [00:09<00:00, 246.75it/s]
=========begin to eval==========
Traceback (most recent call last):
  File "train_MIL.py", line 75, in <module>
    for idx, (batch, label) in enumerate(val_dataloader):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 819, in __next__
    return self._process_data(data)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 846, in _process_data
    data.reraise()
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/_utils.py", line 385, in reraise
    raise self.exc_type(msg)
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nfs/nfs7/home/xiziwang/projects/stad-cvpr2020/baselines/VideoAnomalyDetection/MIL_ucf_cvpr2018/A3D_MIL_dataset.py", line 76, in __getitem__
    for i in range(self.abnormal_dict[self.all_vids[label][index]]['abnormal_start'] - 1,
KeyError: 'abnormal_start'

