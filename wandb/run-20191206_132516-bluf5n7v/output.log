  0%|                                                                                                                                | 0/2248 [00:00<?, ?it/s]  0%|                                                                                                                        | 1/2248 [00:00<14:34,  2.57it/s]  1%|█▌                                                                                                                     | 29/2248 [00:00<10:06,  3.66it/s]  3%|███                                                                                                                    | 58/2248 [00:00<07:01,  5.19it/s]  4%|████▍                                                                                                                  | 84/2248 [00:00<04:54,  7.36it/s]  5%|█████▋                                                                                                                | 109/2248 [00:00<03:26, 10.38it/s]  6%|███████                                                                                                               | 135/2248 [00:00<02:24, 14.57it/s]  7%|████████▍                                                                                                             | 161/2248 [00:00<01:42, 20.32it/s]  8%|█████████▊                                                                                                            | 187/2248 [00:01<01:13, 28.08it/s]  9%|███████████▏                                                                                                          | 213/2248 [00:01<00:53, 38.32it/s] 11%|████████████▋                                                                                                         | 241/2248 [00:01<00:38, 51.64it/s] 12%|██████████████                                                                                                        | 268/2248 [00:01<00:29, 68.12it/s] 13%|███████████████▍                                                                                                      | 294/2248 [00:01<00:22, 87.42it/s] 14%|████████████████▊                                                                                                    | 322/2248 [00:01<00:17, 109.80it/s] 16%|██████████████████▏                                                                                                  | 349/2248 [00:01<00:14, 133.13it/s] 17%|███████████████████▌                                                                                                 | 376/2248 [00:01<00:12, 155.61it/s] 18%|████████████████████▉                                                                                                | 403/2248 [00:01<00:10, 176.57it/s] 19%|██████████████████████▍                                                                                              | 430/2248 [00:02<00:09, 195.64it/s] 20%|███████████████████████▊                                                                                             | 457/2248 [00:02<00:08, 209.35it/s] 21%|█████████████████████████▏                                                                                           | 483/2248 [00:02<00:07, 220.98it/s] 23%|██████████████████████████▍                                                                                          | 509/2248 [00:02<00:07, 228.74it/s] 24%|███████████████████████████▊                                                                                         | 535/2248 [00:02<00:07, 234.16it/s] 25%|█████████████████████████████▏                                                                                       | 561/2248 [00:02<00:07, 238.03it/s] 26%|██████████████████████████████▌                                                                                      | 588/2248 [00:02<00:06, 245.70it/s] 27%|███████████████████████████████▉                                                                                     | 614/2248 [00:02<00:06, 240.14it/s] 28%|█████████████████████████████████▎                                                                                   | 640/2248 [00:02<00:06, 241.20it/s] 30%|██████████████████████████████████▌                                                                                  | 665/2248 [00:02<00:06, 243.33it/s] 31%|███████████████████████████████████▉                                                                                 | 691/2248 [00:03<00:06, 247.21it/s] 32%|█████████████████████████████████████▍                                                                               | 720/2248 [00:03<00:05, 256.54it/s] 33%|██████████████████████████████████████▉                                                                              | 748/2248 [00:03<00:05, 263.03it/s] 34%|████████████████████████████████████████▎                                                                            | 775/2248 [00:03<00:05, 263.39it/s] 36%|█████████████████████████████████████████▋                                                                           | 802/2248 [00:03<00:05, 260.61it/s] 37%|███████████████████████████████████████████▏                                                                         | 829/2248 [00:03<00:05, 261.58it/s] 38%|████████████████████████████████████████████▌                                                                        | 857/2248 [00:03<00:05, 264.47it/s] 39%|██████████████████████████████████████████████                                                                       | 884/2248 [00:03<00:05, 263.24it/s] 41%|███████████████████████████████████████████████▍                                                                     | 911/2248 [00:03<00:05, 259.40it/s] 42%|████████████████████████████████████████████████▊                                                                    | 937/2248 [00:04<00:05, 259.03it/s] 43%|██████████████████████████████████████████████████▏                                                                  | 964/2248 [00:04<00:04, 259.93it/s] 44%|███████████████████████████████████████████████████▌                                                                 | 991/2248 [00:04<00:04, 262.25it/s] 45%|████████████████████████████████████████████████████▌                                                               | 1018/2248 [00:04<00:04, 264.12it/s] 46%|█████████████████████████████████████████████████████▉                                                              | 1045/2248 [00:04<00:04, 259.46it/s] 48%|███████████████████████████████████████████████████████▎                                                            | 1071/2248 [00:04<00:04, 257.65it/s] 49%|████████████████████████████████████████████████████████▌                                                           | 1097/2248 [00:04<00:04, 257.60it/s] 50%|█████████████████████████████████████████████████████████▉                                                          | 1123/2248 [00:04<00:04, 255.13it/s] 51%|███████████████████████████████████████████████████████████▎                                                        | 1149/2248 [00:04<00:04, 254.89it/s] 52%|████████████████████████████████████████████████████████████▋                                                       | 1177/2248 [00:04<00:04, 260.93it/s] 54%|██████████████████████████████████████████████████████████████▏                                                     | 1204/2248 [00:05<00:04, 260.99it/s] 55%|███████████████████████████████████████████████████████████████▌                                                    | 1231/2248 [00:05<00:04, 251.12it/s] 56%|█████████████████████████████████████████████████████████████████                                                   | 1260/2248 [00:05<00:03, 260.37it/s] 57%|██████████████████████████████████████████████████████████████████▍                                                 | 1287/2248 [00:05<00:03, 258.16it/s] 58%|███████████████████████████████████████████████████████████████████▊                                                | 1313/2248 [00:05<00:03, 256.87it/s] 60%|█████████████████████████████████████████████████████████████████████▏                                              | 1340/2248 [00:05<00:03, 259.72it/s] 61%|██████████████████████████████████████████████████████████████████████▌                                             | 1367/2248 [00:05<00:03, 259.78it/s] 62%|███████████████████████████████████████████████████████████████████████▉                                            | 1394/2248 [00:05<00:03, 261.03it/s] 63%|█████████████████████████████████████████████████████████████████████████▎                                          | 1421/2248 [00:05<00:03, 262.43it/s] 64%|██████████████████████████████████████████████████████████████████████████▋                                         | 1448/2248 [00:05<00:03, 250.67it/s] 66%|████████████████████████████████████████████████████████████████████████████                                        | 1474/2248 [00:06<00:03, 252.84it/s] 67%|█████████████████████████████████████████████████████████████████████████████▍                                      | 1501/2248 [00:06<00:02, 255.34it/s] 68%|██████████████████████████████████████████████████████████████████████████████▊                                     | 1527/2248 [00:06<00:02, 254.01it/s] 69%|████████████████████████████████████████████████████████████████████████████████▎                                   | 1556/2248 [00:06<00:02, 261.50it/s] 70%|█████████████████████████████████████████████████████████████████████████████████▋                                  | 1584/2248 [00:06<00:02, 265.82it/s] 72%|███████████████████████████████████████████████████████████████████████████████████▏                                | 1611/2248 [00:06<00:02, 264.47it/s] 73%|████████████████████████████████████████████████████████████████████████████████████▌                               | 1639/2248 [00:06<00:02, 268.29it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████▉                              | 1666/2248 [00:06<00:02, 265.76it/s] 75%|███████████████████████████████████████████████████████████████████████████████████████▍                            | 1695/2248 [00:06<00:02, 271.60it/s] 77%|████████████████████████████████████████████████████████████████████████████████████████▉                           | 1723/2248 [00:07<00:02, 256.22it/s] 78%|██████████████████████████████████████████████████████████████████████████████████████████▎                         | 1751/2248 [00:07<00:01, 261.55it/s] 79%|███████████████████████████████████████████████████████████████████████████████████████████▋                        | 1778/2248 [00:07<00:01, 261.15it/s] 80%|█████████████████████████████████████████████████████████████████████████████████████████████▏                      | 1805/2248 [00:07<00:01, 257.71it/s] 81%|██████████████████████████████████████████████████████████████████████████████████████████████▌                     | 1832/2248 [00:07<00:01, 259.48it/s] 83%|███████████████████████████████████████████████████████████████████████████████████████████████▉                    | 1859/2248 [00:07<00:01, 260.17it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 1886/2248 [00:07<00:01, 258.30it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 1912/2248 [00:07<00:01, 254.65it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████████████████                | 1938/2248 [00:07<00:01, 254.67it/s] 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎              | 1964/2248 [00:07<00:01, 252.24it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 1992/2248 [00:08<00:00, 258.08it/s] 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 2018/2248 [00:08<00:00, 248.39it/s] 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 2046/2248 [00:08<00:00, 254.79it/s] 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████         | 2075/2248 [00:08<00:00, 261.99it/s] 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 2102/2248 [00:08<00:00, 260.62it/s] 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 2129/2248 [00:08<00:00, 261.62it/s] 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 2156/2248 [00:08<00:00, 256.58it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 2183/2248 [00:08<00:00, 259.51it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████  | 2210/2248 [00:08<00:00, 259.03it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 2236/2248 [00:09<00:00, 258.70it/s]=========begin to eval==========
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2248/2248 [00:09<00:00, 247.21it/s]
{'video_start': 1723, 'video_end': 1778, 'anomaly_start': 39, 'anomaly_end': 55, 'anomaly_class': '3', 'num_frames': 56, 'subset': 'train'}
39
55
{'video_start': 4142, 'video_end': 4280, 'anomaly_start': 41, 'anomaly_end': 84, 'anomaly_class': '3', 'num_frames': 139, 'subset': 'train'}
41
84
{'video_start': 2784, 'video_end': 2830, 'anomaly_start': 29, 'anomaly_end': 43, 'anomaly_class': '5', 'num_frames': 47, 'subset': 'train'}
29
43
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 1 1 1 1 1 1 1 1 1 1] [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1]
[] []
{'video_start': 1975, 'video_end': 2113, 'anomaly_start': 62, 'anomaly_end': 112, 'anomaly_class': '2', 'num_frames': 139, 'subset': 'train'}
62
112
{'video_start': 1718, 'video_end': 1845, 'anomaly_start': 67, 'anomaly_end': 97, 'anomaly_class': '3', 'num_frames': 128, 'subset': 'train'}
67
97
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1] [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
{'video_start': 2839, 'video_end': 2938, 'anomaly_start': 36, 'anomaly_end': 90, 'anomaly_class': '2', 'num_frames': 100, 'subset': 'train'}
36
[] []
90
[] []
{'video_start': 1634, 'video_end': 1718, 'anomaly_start': 31, 'anomaly_end': 76, 'anomaly_class': '5', 'num_frames': 85, 'subset': 'train'}
31
76
[] []
{'video_start': 908, 'video_end': 996, 'anomaly_start': 36, 'anomaly_end': 48, 'anomaly_class': '5', 'num_frames': 89, 'subset': 'train'}
36
48
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 0 0 0 0 0] [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1]
{'video_start': 2288, 'video_end': 2426, 'anomaly_start': 78, 'anomaly_end': 138, 'anomaly_class': '7', 'num_frames': 139, 'subset': 'train'}
78
138
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1
 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0] [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1]
{'video_start': 4974, 'video_end': 5052, 'anomaly_start': 30, 'anomaly_end': 78, 'anomaly_class': '3', 'num_frames': 79, 'subset': 'train'}
30
78
{'video_start': 5070, 'video_end': 5188, 'anomaly_start': 50, 'anomaly_end': 101, 'anomaly_class': '10', 'num_frames': 119, 'subset': 'train'}
50
101
[] []
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1] [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
{'video_start': 2834, 'video_end': 2959, 'anomaly_start': 42, 'anomaly_end': 88, 'anomaly_class': '10', 'num_frames': 126, 'subset': 'train'}
42
88
[] []
{'video_start': 652, 'video_end': 750, 'anomaly_start': 43, 'anomaly_end': 54, 'anomaly_class': '5', 'num_frames': 99, 'subset': 'train'}
43
54
{'video_start': 703, 'video_end': 819, 'anomaly_start': 59, 'anomaly_end': 84, 'anomaly_class': '5', 'num_frames': 117, 'subset': 'train'}
59
84
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0] [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1]
{'video_start': 337, 'video_end': 445, 'anomaly_start': None, 'anomaly_end': 108, 'anomaly_class': '7', 'num_frames': 109, 'subset': 'train'}
None
108
[] []
[] []
{'video_start': 4922, 'video_end': 4992, 'anomaly_start': 36, 'anomaly_end': 70, 'anomaly_class': '2', 'num_frames': 71, 'subset': 'train'}
36
70
Traceback (most recent call last):
  File "train_MIL.py", line 75, in <module>
    for idx, (batch, label) in enumerate(val_dataloader):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 819, in __next__
    return self._process_data(data)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 846, in _process_data
    data.reraise()
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/_utils.py", line 385, in reraise
    raise self.exc_type(msg)
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nfs/nfs7/home/xiziwang/projects/stad-cvpr2020/baselines/VideoAnomalyDetection/MIL_ucf_cvpr2018/A3D_MIL_dataset.py", line 79, in __getitem__
    for i in range(self.abnormal_dict[self.all_vids[label][index]]['anomaly_start'] - 1,
TypeError: unsupported operand type(s) for -: 'NoneType' and 'int'

{'video_start': 1222, 'video_end': 1342, 'anomaly_start': 37, 'anomaly_end': 61, 'anomaly_class': '7', 'num_frames': 121, 'subset': 'train'}
37
61
