  0%|                                                                                                                                | 0/2248 [00:00<?, ?it/s]  0%|                                                                                                                        | 1/2248 [00:00<13:39,  2.74it/s]  1%|█▍                                                                                                                     | 27/2248 [00:00<09:29,  3.90it/s]  2%|██▉                                                                                                                    | 56/2248 [00:00<06:35,  5.54it/s]  4%|████▍                                                                                                                  | 84/2248 [00:00<04:35,  7.84it/s]  5%|█████▊                                                                                                                | 110/2248 [00:00<03:13, 11.06it/s]  6%|███████▏                                                                                                              | 137/2248 [00:00<02:16, 15.51it/s]  7%|████████▌                                                                                                             | 162/2248 [00:00<01:36, 21.58it/s]  8%|█████████▉                                                                                                            | 189/2248 [00:01<01:09, 29.79it/s] 10%|███████████▎                                                                                                          | 215/2248 [00:01<00:50, 40.56it/s] 11%|████████████▌                                                                                                         | 240/2248 [00:01<00:37, 54.12it/s] 12%|██████████████                                                                                                        | 268/2248 [00:01<00:27, 71.28it/s] 13%|███████████████▍                                                                                                      | 294/2248 [00:01<00:21, 90.48it/s] 14%|████████████████▋                                                                                                    | 320/2248 [00:01<00:17, 111.27it/s] 16%|██████████████████▏                                                                                                  | 349/2248 [00:01<00:13, 135.78it/s] 17%|███████████████████▌                                                                                                 | 375/2248 [00:01<00:11, 157.92it/s] 18%|████████████████████▊                                                                                                | 401/2248 [00:01<00:10, 176.83it/s] 19%|██████████████████████▍                                                                                              | 430/2248 [00:02<00:09, 199.01it/s] 20%|███████████████████████▉                                                                                             | 459/2248 [00:02<00:08, 219.31it/s] 22%|█████████████████████████▎                                                                                           | 486/2248 [00:02<00:07, 229.72it/s] 23%|██████████████████████████▋                                                                                          | 513/2248 [00:02<00:07, 228.21it/s] 24%|████████████████████████████▏                                                                                        | 541/2248 [00:02<00:07, 240.23it/s] 25%|█████████████████████████████▌                                                                                       | 567/2248 [00:02<00:06, 241.74it/s] 26%|██████████████████████████████▉                                                                                      | 594/2248 [00:02<00:06, 249.20it/s] 28%|████████████████████████████████▎                                                                                    | 620/2248 [00:02<00:06, 248.89it/s] 29%|█████████████████████████████████▋                                                                                   | 647/2248 [00:02<00:06, 253.45it/s] 30%|███████████████████████████████████                                                                                  | 674/2248 [00:02<00:06, 256.93it/s] 31%|████████████████████████████████████▍                                                                                | 701/2248 [00:03<00:05, 259.16it/s] 32%|█████████████████████████████████████▉                                                                               | 729/2248 [00:03<00:05, 262.82it/s] 34%|███████████████████████████████████████▎                                                                             | 756/2248 [00:03<00:05, 257.56it/s] 35%|████████████████████████████████████████▊                                                                            | 784/2248 [00:03<00:05, 261.85it/s] 36%|██████████████████████████████████████████▏                                                                          | 811/2248 [00:03<00:05, 252.80it/s] 37%|███████████████████████████████████████████▌                                                                         | 838/2248 [00:03<00:05, 257.06it/s] 38%|█████████████████████████████████████████████                                                                        | 865/2248 [00:03<00:05, 259.14it/s] 40%|██████████████████████████████████████████████▍                                                                      | 893/2248 [00:03<00:05, 263.52it/s] 41%|███████████████████████████████████████████████▉                                                                     | 921/2248 [00:03<00:04, 266.18it/s] 42%|█████████████████████████████████████████████████▍                                                                   | 949/2248 [00:03<00:04, 268.60it/s] 43%|██████████████████████████████████████████████████▊                                                                  | 976/2248 [00:04<00:04, 264.02it/s] 45%|███████████████████████████████████████████████████▊                                                                | 1003/2248 [00:04<00:04, 255.39it/s] 46%|█████████████████████████████████████████████████████                                                               | 1029/2248 [00:04<00:04, 255.92it/s] 47%|██████████████████████████████████████████████████████▋                                                             | 1059/2248 [00:04<00:04, 265.25it/s] 48%|████████████████████████████████████████████████████████                                                            | 1086/2248 [00:04<00:04, 261.88it/s] 50%|█████████████████████████████████████████████████████████▍                                                          | 1113/2248 [00:04<00:04, 256.53it/s] 51%|██████████████████████████████████████████████████████████▉                                                         | 1141/2248 [00:04<00:04, 261.66it/s] 52%|████████████████████████████████████████████████████████████▎                                                       | 1170/2248 [00:04<00:04, 268.19it/s] 53%|█████████████████████████████████████████████████████████████▊                                                      | 1198/2248 [00:04<00:03, 268.67it/s] 54%|███████████████████████████████████████████████████████████████▏                                                    | 1225/2248 [00:05<00:03, 264.17it/s] 56%|████████████████████████████████████████████████████████████████▋                                                   | 1253/2248 [00:05<00:03, 266.47it/s] 57%|██████████████████████████████████████████████████████████████████▏                                                 | 1282/2248 [00:05<00:03, 272.97it/s] 58%|███████████████████████████████████████████████████████████████████▌                                                | 1310/2248 [00:05<00:03, 269.77it/s] 60%|█████████████████████████████████████████████████████████████████████                                               | 1338/2248 [00:05<00:03, 265.38it/s] 61%|██████████████████████████████████████████████████████████████████████▍                                             | 1365/2248 [00:05<00:03, 260.48it/s] 62%|███████████████████████████████████████████████████████████████████████▉                                            | 1393/2248 [00:05<00:03, 264.17it/s] 63%|█████████████████████████████████████████████████████████████████████████▎                                          | 1420/2248 [00:05<00:03, 254.47it/s] 64%|██████████████████████████████████████████████████████████████████████████▌                                         | 1446/2248 [00:05<00:03, 255.80it/s] 65%|███████████████████████████████████████████████████████████████████████████▉                                        | 1472/2248 [00:06<00:03, 253.42it/s] 67%|█████████████████████████████████████████████████████████████████████████████▎                                      | 1498/2248 [00:06<00:02, 251.21it/s] 68%|██████████████████████████████████████████████████████████████████████████████▋                                     | 1526/2248 [00:06<00:02, 259.02it/s] 69%|████████████████████████████████████████████████████████████████████████████████▏                                   | 1553/2248 [00:06<00:02, 261.42it/s] 70%|█████████████████████████████████████████████████████████████████████████████████▌                                  | 1580/2248 [00:06<00:02, 263.29it/s] 71%|██████████████████████████████████████████████████████████████████████████████████▉                                 | 1607/2248 [00:06<00:02, 256.07it/s] 73%|████████████████████████████████████████████████████████████████████████████████████▎                               | 1633/2248 [00:06<00:02, 256.08it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████▋                              | 1660/2248 [00:06<00:02, 259.83it/s] 75%|███████████████████████████████████████████████████████████████████████████████████████                             | 1687/2248 [00:06<00:02, 255.15it/s] 76%|████████████████████████████████████████████████████████████████████████████████████████▍                           | 1713/2248 [00:06<00:02, 247.08it/s] 77%|█████████████████████████████████████████████████████████████████████████████████████████▋                          | 1739/2248 [00:07<00:02, 249.53it/s] 79%|███████████████████████████████████████████████████████████████████████████████████████████▏                        | 1766/2248 [00:07<00:01, 254.30it/s] 80%|████████████████████████████████████████████████████████████████████████████████████████████▌                       | 1794/2248 [00:07<00:01, 260.79it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████▉                      | 1821/2248 [00:07<00:01, 260.58it/s] 82%|███████████████████████████████████████████████████████████████████████████████████████████████▎                    | 1848/2248 [00:07<00:01, 257.25it/s] 83%|████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 1876/2248 [00:07<00:01, 263.48it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 1903/2248 [00:07<00:01, 257.85it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████████████████▌                | 1929/2248 [00:07<00:01, 251.80it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████▉               | 1957/2248 [00:07<00:01, 257.05it/s] 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍             | 1984/2248 [00:07<00:01, 258.72it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋            | 2010/2248 [00:08<00:00, 255.46it/s] 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████           | 2036/2248 [00:08<00:00, 251.14it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 2062/2248 [00:08<00:00, 252.05it/s] 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 2088/2248 [00:08<00:00, 248.53it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 2115/2248 [00:08<00:00, 251.68it/s] 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 2143/2248 [00:08<00:00, 257.00it/s] 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 2170/2248 [00:08<00:00, 257.76it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 2197/2248 [00:08<00:00, 260.02it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 2224/2248 [00:08<00:00, 260.60it/s]=========begin to eval==========
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2248/2248 [00:09<00:00, 248.53it/s]
Traceback (most recent call last):
  File "train_MIL.py", line 75, in <module>
    for idx, (batch, label) in enumerate(val_dataloader):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 819, in __next__
    return self._process_data(data)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 846, in _process_data
    data.reraise()
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/_utils.py", line 385, in reraise
    raise self.exc_type(msg)
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nfs/nfs7/home/xiziwang/projects/stad-cvpr2020/baselines/VideoAnomalyDetection/MIL_ucf_cvpr2018/A3D_MIL_dataset.py", line 74, in __getitem__
    Anomaly_labels = np.zeros(self.abnormal_dict[self.all_vids[label]]['num_frames'],
TypeError: unhashable type: 'list'

