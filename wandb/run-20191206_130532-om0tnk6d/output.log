  0%|                                                                                                                                | 0/2248 [00:00<?, ?it/s]  0%|                                                                                                                        | 1/2248 [00:00<12:40,  2.95it/s]  1%|█▎                                                                                                                     | 25/2248 [00:00<08:49,  4.20it/s]  2%|██▊                                                                                                                    | 52/2248 [00:00<06:08,  5.95it/s]  3%|████▏                                                                                                                  | 78/2248 [00:00<04:17,  8.42it/s]  5%|█████▍                                                                                                                | 104/2248 [00:00<03:00, 11.87it/s]  6%|██████▉                                                                                                               | 131/2248 [00:00<02:07, 16.63it/s]  7%|████████▏                                                                                                             | 157/2248 [00:00<01:30, 23.12it/s]  8%|█████████▋                                                                                                            | 184/2248 [00:01<01:04, 31.85it/s]  9%|██████████▉                                                                                                           | 209/2248 [00:01<00:47, 43.06it/s] 10%|████████████▍                                                                                                         | 236/2248 [00:01<00:34, 57.55it/s] 12%|█████████████▊                                                                                                        | 263/2248 [00:01<00:26, 75.21it/s] 13%|███████████████▏                                                                                                      | 290/2248 [00:01<00:20, 95.67it/s] 14%|████████████████▍                                                                                                    | 316/2248 [00:01<00:16, 117.12it/s] 15%|█████████████████▊                                                                                                   | 342/2248 [00:01<00:13, 139.49it/s] 16%|███████████████████▏                                                                                                 | 368/2248 [00:01<00:11, 160.70it/s] 18%|████████████████████▌                                                                                                | 394/2248 [00:01<00:10, 174.77it/s] 19%|█████████████████████▊                                                                                               | 419/2248 [00:01<00:09, 191.92it/s] 20%|███████████████████████▎                                                                                             | 447/2248 [00:02<00:08, 211.78it/s] 21%|████████████████████████▌                                                                                            | 473/2248 [00:02<00:08, 221.56it/s] 22%|██████████████████████████                                                                                           | 500/2248 [00:02<00:07, 231.43it/s] 23%|███████████████████████████▍                                                                                         | 527/2248 [00:02<00:07, 239.89it/s] 25%|████████████████████████████▊                                                                                        | 554/2248 [00:02<00:06, 246.58it/s] 26%|██████████████████████████████▏                                                                                      | 580/2248 [00:02<00:06, 245.74it/s] 27%|███████████████████████████████▌                                                                                     | 606/2248 [00:02<00:06, 248.58it/s] 28%|████████████████████████████████▉                                                                                    | 632/2248 [00:02<00:06, 250.01it/s] 29%|██████████████████████████████████▏                                                                                  | 658/2248 [00:02<00:06, 250.55it/s] 30%|███████████████████████████████████▌                                                                                 | 684/2248 [00:03<00:06, 247.73it/s] 32%|████████████████████████████████████▉                                                                                | 709/2248 [00:03<00:06, 245.69it/s] 33%|██████████████████████████████████████▍                                                                              | 738/2248 [00:03<00:05, 255.49it/s] 34%|███████████████████████████████████████▊                                                                             | 764/2248 [00:03<00:05, 251.25it/s] 35%|█████████████████████████████████████████                                                                            | 790/2248 [00:03<00:05, 253.71it/s] 36%|██████████████████████████████████████████▍                                                                          | 816/2248 [00:03<00:05, 251.60it/s] 37%|███████████████████████████████████████████▊                                                                         | 842/2248 [00:03<00:05, 250.12it/s] 39%|█████████████████████████████████████████████▏                                                                       | 868/2248 [00:03<00:05, 243.28it/s] 40%|██████████████████████████████████████████████▍                                                                      | 893/2248 [00:03<00:05, 242.02it/s] 41%|███████████████████████████████████████████████▊                                                                     | 919/2248 [00:03<00:05, 246.63it/s] 42%|█████████████████████████████████████████████████▏                                                                   | 945/2248 [00:04<00:05, 249.29it/s] 43%|██████████████████████████████████████████████████▌                                                                  | 972/2248 [00:04<00:05, 254.38it/s] 44%|███████████████████████████████████████████████████▉                                                                 | 999/2248 [00:04<00:04, 257.28it/s] 46%|████████████████████████████████████████████████████▉                                                               | 1025/2248 [00:04<00:04, 257.74it/s] 47%|██████████████████████████████████████████████████████▏                                                             | 1051/2248 [00:04<00:04, 250.88it/s] 48%|███████████████████████████████████████████████████████▋                                                            | 1078/2248 [00:04<00:04, 255.98it/s] 49%|████████████████████████████████████████████████████████▉                                                           | 1104/2248 [00:04<00:04, 255.12it/s] 50%|██████████████████████████████████████████████████████████▎                                                         | 1130/2248 [00:04<00:04, 249.95it/s] 51%|███████████████████████████████████████████████████████████▋                                                        | 1156/2248 [00:04<00:04, 250.55it/s] 53%|█████████████████████████████████████████████████████████████                                                       | 1183/2248 [00:05<00:04, 254.84it/s] 54%|██████████████████████████████████████████████████████████████▍                                                     | 1209/2248 [00:05<00:04, 248.85it/s] 55%|███████████████████████████████████████████████████████████████▋                                                    | 1234/2248 [00:05<00:04, 247.42it/s] 56%|█████████████████████████████████████████████████████████████████                                                   | 1262/2248 [00:05<00:03, 254.97it/s] 57%|██████████████████████████████████████████████████████████████████▌                                                 | 1291/2248 [00:05<00:03, 261.99it/s] 59%|████████████████████████████████████████████████████████████████████                                                | 1318/2248 [00:05<00:03, 259.42it/s] 60%|█████████████████████████████████████████████████████████████████████▍                                              | 1345/2248 [00:05<00:03, 261.40it/s] 61%|██████████████████████████████████████████████████████████████████████▊                                             | 1372/2248 [00:05<00:03, 258.82it/s] 62%|████████████████████████████████████████████████████████████████████████▏                                           | 1399/2248 [00:05<00:03, 259.88it/s] 63%|█████████████████████████████████████████████████████████████████████████▌                                          | 1426/2248 [00:05<00:03, 251.30it/s] 65%|██████████████████████████████████████████████████████████████████████████▉                                         | 1453/2248 [00:06<00:03, 254.90it/s] 66%|████████████████████████████████████████████████████████████████████████████▎                                       | 1479/2248 [00:06<00:03, 247.33it/s] 67%|█████████████████████████████████████████████████████████████████████████████▊                                      | 1507/2248 [00:06<00:02, 254.31it/s] 68%|███████████████████████████████████████████████████████████████████████████████                                     | 1533/2248 [00:06<00:02, 251.70it/s] 69%|████████████████████████████████████████████████████████████████████████████████▍                                   | 1559/2248 [00:06<00:02, 252.72it/s] 71%|█████████████████████████████████████████████████████████████████████████████████▊                                  | 1585/2248 [00:06<00:02, 247.62it/s] 72%|███████████████████████████████████████████████████████████████████████████████████                                 | 1610/2248 [00:06<00:02, 247.07it/s] 73%|████████████████████████████████████████████████████████████████████████████████████▎                               | 1635/2248 [00:06<00:02, 246.43it/s] 74%|█████████████████████████████████████████████████████████████████████████████████████▋                              | 1660/2248 [00:06<00:02, 247.37it/s] 75%|███████████████████████████████████████████████████████████████████████████████████████                             | 1687/2248 [00:06<00:02, 252.81it/s] 76%|████████████████████████████████████████████████████████████████████████████████████████▍                           | 1713/2248 [00:07<00:02, 254.46it/s] 77%|█████████████████████████████████████████████████████████████████████████████████████████▋                          | 1739/2248 [00:07<00:02, 251.45it/s] 79%|███████████████████████████████████████████████████████████████████████████████████████████                         | 1765/2248 [00:07<00:01, 248.71it/s] 80%|████████████████████████████████████████████████████████████████████████████████████████████▍                       | 1791/2248 [00:07<00:01, 250.59it/s] 81%|█████████████████████████████████████████████████████████████████████████████████████████████▊                      | 1819/2248 [00:07<00:01, 256.65it/s] 82%|███████████████████████████████████████████████████████████████████████████████████████████████▎                    | 1847/2248 [00:07<00:01, 263.11it/s] 83%|████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 1874/2248 [00:07<00:01, 258.49it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████████████████                  | 1900/2248 [00:07<00:01, 246.76it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                | 1927/2248 [00:07<00:01, 252.08it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 1954/2248 [00:08<00:01, 256.88it/s] 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏             | 1981/2248 [00:08<00:01, 259.11it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 2008/2248 [00:08<00:00, 258.45it/s] 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 2034/2248 [00:08<00:00, 255.95it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 2060/2248 [00:08<00:00, 254.05it/s] 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 2087/2248 [00:08<00:00, 258.34it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 2113/2248 [00:08<00:00, 258.44it/s] 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 2139/2248 [00:08<00:00, 258.55it/s] 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 2166/2248 [00:08<00:00, 261.18it/s] 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 2194/2248 [00:08<00:00, 265.25it/s] 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 2221/2248 [00:09<00:00, 265.17it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2248/2248 [00:09<00:00, 263.92it/s]=========begin to eval==========
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2248/2248 [00:09<00:00, 244.23it/s]
Traceback (most recent call last):
  File "train_MIL.py", line 75, in <module>
    for idx, (batch, label) in enumerate(val_dataloader):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 819, in __next__
    return self._process_data(data)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 846, in _process_data
    data.reraise()
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/_utils.py", line 385, in reraise
    raise self.exc_type(msg)
UnboundLocalError: Caught UnboundLocalError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nobackup/xiziwang/usr/local/miniconda3/envs/tf/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/nfs/nfs7/home/xiziwang/projects/stad-cvpr2020/baselines/VideoAnomalyDetection/MIL_ucf_cvpr2018/A3D_MIL_dataset.py", line 66, in __getitem__
    All_features.append(torch.from_numpy(feature))
UnboundLocalError: local variable 'All_features' referenced before assignment

